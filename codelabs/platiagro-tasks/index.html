
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Criação de Tarefas</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="platiagro-tasks"
                  title="Criação de Tarefas"
                  environment="web"
                  feedback-link="https://github.com/platiagro/tutorials">
    
      <google-codelab-step label="Introdução" duration="1">
        <p>Para criar uma tarefa, o usuário deverá clicar no menu Tarefas e depois no botão <img alt=" + Nova Tarefa " src="img/451cd0f2d19fca7.png">.</p>
<p class="image-container"><img alt="Página Tarefas" src="img/cac0d90f969aa784.png"></p>
<p><strong>Descrição:</strong> Na página &#34;Tarefas&#34;, será apresentada uma lista com todas as tarefas existentes. As informações das tarefas estarão divididas em três colunas: Nome da Tarefa, Descrição e Ação.<br>Nesta tela serão apresentadas as tarefas da plataforma e dos usuários.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Seleção da nova tarefa" duration="2">
        <p>A plataforma oferece uma série de exemplos para iniciar nova tarefa. Ela também oferece uma opção em branco.</p>
<p class="image-container"><img alt="Página Nova Tarefa" src="img/fefe00c7e6b957ec.png"></p>
<p><strong>Descrição:</strong> A janela &#34;Nova Tarefa&#34;, possui dois campos obrigatórios (assinalados com asterisco) e um opcional.<br>O primeiro campo obrigatório é o tipo do exemplo ou &#34;template&#34; inicial. A plataforma oferece grande quantidade de exemplos envolvendo classificação, regressão, seleção de &#34;features&#34; e muitos outros.<br>O segundo campo obrigatório é o nome da tarefa. O nome da tarefa será mostrado junto com os outros nomes então escolha um nome que facilite encontrar sua tarefa no futuro.<br>O campo opcional é uma descrição de sua tarefa. Se não precisar descrever ou registrar algum detalhe importante pode ficar em branco.<br>O botão &#34;Cancelar&#34; fecha esta janela e volta para a anterior sem gravar nada.<br>O botão &#34;Criar Notebooks&#34; abre nova aba no seu navegador com três divisões que serão comentadas na próxima seção deste tutorial.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Criação de Tarefas em Branco" duration="4">
        <p>Após selecionar e preencher os campos necessários a plataforma abre nova aba com as divisões Experiment.jpynb e Deployment.jpynb.</p>
<p class="image-container"><img alt="Nova Tarefa em Branco" src="img/9f444d437d4293f5.png"></p>
<p><strong>Descrição:</strong> A aba &#34;Nova Tarefa&#34;, possui algumas divisões criadas para orientar a elaboração da tarefa que serão comentados em outra seção.<br>Esta aba é criada com as divisões Experiment.jpynb e Deployment.jpynb. Também pode ser criada outra seção para Terminal onde podem ser executados comandos do Unix/Linux.<br>Nesta aba também podem ser visualizados os artefatos da tarefa e a localização destes artefatos no servidor.<br>   Obs.1: o sinal de adição <img alt=" insert a cell " src="img/54744bd8322b702d.png"> no menu superior cria mais uma célula para seus códigos<br>   Obs.2: o ícone com a tesoura <img alt=" cut a cell " src="img/9478d2543a42c8a.png"> remove a célula selecionada<br>   Obs.3: use CONTRL-ENTER para executar a célula selecionada porque o triângulo no alto da tela (Run...) não faz nada<br>   Obs.4: o ícone <img alt=" add parameter " src="img/2bd9ed3eb3bbae78.png"> serve para inserir novo parâmetro (&#34;input&#34;)</p>
<p class="image-container"><img alt="Input" src="img/368c76fe7e3cdcf.png"></p>
<p><strong>Descrição:</strong> A janela &#34;Add Parameter&#34;, possui alguns campos sobre o novo parâmetro.<br>O campo &#34;Variable name&#34; deve ser preenchido levando em consideração as regras para nomes de variáveis em Python.<br>O campo &#34;Label&#34; deve ser preenchido com o nome que vai aparecer na área de parâmetros da plataforma que abre em uma aba lateral.</p>
<p class="image-container"><img alt="Dataset" src="img/7a56943e8cb5ebb1.png"></p>
<p>É importante ressaltar que um dataset deve ter o método read(), como um dataframe Pandas.</p>
<p class="image-container"><img alt="Experiment" src="img/e1fae41096ee5770.png"></p>
<p>Neste exemplo foi criado um parâmetro (input) que aparece no Experiment.jpynb como &#34;var_name&#34; e aparece na aba lateral com a identificação &#34;var_label&#34;.</p>
<p class="image-container"><img alt="Aba lateral" src="img/2b451560454aa85b.png"></p>
<p>O ícone parecido com uma pasta branca na parte de baixo da lateral esquerda serve para exibir os principais artefatos da tarefa: Experiment.jpynb e Deployment.jpynb</p>
<p class="image-container"><img alt="Open tabs" src="img/2c3a16bc0b1a20ac.png"></p>
<p>O ícone parecido com uma pasta preta na parte de cima da lateral esquerda serve para exibir um navegador de arquivos que mostra todos os artefatos da tarefa e sua localização no servidor</p>
<p class="image-container"><img alt="File browser" src="img/4f0ebac426fe86ca.png"></p>
<p>O sinal de adição no menu superior à direita da pasta preta serve para abrir o ícone para o &#34;Terminal de comandos&#34; e outras funcionalidades</p>
<p class="image-container"><img alt="New launcher" src="img/5e1bc11a0ada4a75.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Mostrar Terminal de Comandos Unix/Linux" duration="1">
        <p>Neste exemplo foram usados alguns comandos para verificar em que local do servidor estão localizados os arquivos desta tarefa.</p>
<p class="image-container"><img alt="Terminal" src="img/d2f4b81689a8992d.png"></p>
<p>O símbolo que parece uma pasta preta com sinal de adição serve para criar novas pastas na pasta atual.<br>O símbolo que parece uma seta para cima sobre uma barra serve para fazer upload de arquivos da máquina do usuário para a pasta do projeto. É importante ressaltar que esta pasta é temporária e os arquivos carregados nesta pasta deverão ser carregados novamente para futuras pastas deta tarefa.<br>A maneira de fazer com que os arquivos necessários sejam copiados automaticamente para esta pasta é via o comando wget.<br>Exemplo &#34;wget https://raw.githubusercontent.com/platiagro/.../nome_arquivo.csv&#34;</p>


      </google-codelab-step>
    
      <google-codelab-step label="Importar Classes e Métodos" duration="1">
        <p>Se o código for grande é melhor criar classes e importar no componente com &#34;from file import classes, métodos&#34;<br>Para importar classes e métodos no componente primeiro precisa carregar o arquivo .py para a pasta do componente</p>
<p>Passos para levar arquivos até a pasta do componente:<br>   a) encontrar a URL do arquivo de origem no github ou equivalente<br>   b) executar wget em uma céula do Experiment. Exemplo:</p>
<pre><code>  !wget https://github.com/platiagro/.../nome_arquivo.py
</code></pre>
<p class="image-container"><img alt="Importar classes" src="img/5b7f49a8d55b0ed4.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Mostrar Resultados Aba Lateral" duration="1">
        <p>Mostrar resultados em forma de tabela renderizada usando dataframe Pandas e Matplotlib.<br>   Obs.1: Não pode usar plt.show() porque ele limpa o objeto e depois não aparece nada na aba lateral de resultados</p>
<pre><code>      Precisa terminar com: 
         save_figure(figure=plt.gcf())
         plt.clf()
</code></pre>
<p class="image-container"><img alt="Mostrar resultados codigo" src="img/85622b779ace9f2.png"></p>
<p>Se tudo correu bem então a tabela renderizada aparece nesta aba lateral da plataforma.</p>
<p class="image-container"><img alt="Mostrar resultados aba lateral" src="img/4078c390c488b29c.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Aba Deployment" duration="2">
        <p>A aba <strong>Deployment</strong> armazena o código necessário para a plataforma executar no servidor o modelo que foi criado na aba Experiment.<br>O modelo deve ser importado e encapsulado na classe Model então esta classe precisa implementar o método &#34;predict()&#34;.<br>A primeira seção desta aba serve para <strong>identificação</strong> da atividade, do autor e de seus principais objetivos.<br>Recomenda-se que sejam registrados o nome do autor e a data de criação.</p>
<p class="image-container"><img alt="Identificar classe" src="img/dd886589fc1c8190.png"></p>
<p>A segunda seção <strong>define a classe Model</strong> que precisa implementar o método &#34;predict()&#34; para ser executado pelo servidor.<br>Neste exemplo o método &#34;predict()&#34; apenas mostra o parâmetro recebido e retorna este parâmetro para a interface gráfica.<br>As capturas de tela da interface gráfica serão mostradas no final deste tutorial porém a aba Deploymente também pode ser usada para conferir o resultado.</p>
<p class="image-container"><img alt="Declarar classe" src="img/4eb870bb10265a30.png"></p>
<p>Note que a classe modelo deve retornar uma lista então talvez seja necessário acrescentar o método class_names().<br>Outro ajuste importante para modelos regressores é o retorno convertido para um array numpy.</p>
<p class="image-container"><img alt="Definir predict" src="img/2dac50b20852be9.png"></p>
<p>A seção <strong>Teste do serviço REST</strong> orienta como o pesquisador pode testar o resultado da execução de seu modelo.<br>Ela ajuda a criar um arquivo com um objeto json (JavaScipt Object Notation) para ser enviado ao seu modelo via protocolo REST.</p>
<p class="image-container"><img alt="Teste Rest" src="img/3a7653d8e625a33b.png"></p>
<p>É importante ressaltar que o valor enviado ao modelo será sorteado de um intervalo que deve ser especificado na área <strong>&#34;range&#34;</strong> do objeto json.</p>
<p class="image-container"><img alt="Teste json" src="img/75cb0856382113b9.png"></p>
<p>Se o modelo for do tipo Regressor então o arquivo json precisa ser ajustado.<br>Neste exemplo o modelo espera um arquio com duas colunas contendo valores numéricos.<br>Por isto a coluna &#34;p0&#34; tem o range [5.0, 5.0] e a coluna &#34;p1&#34; tem o range [6.0, 6.0], assim a plataforma vai sortear um valor entre 5 e 5 para a primeira coluna e um valor entre 6 e 6 para a segunda coluna.</p>
<p class="image-container"><img alt="Arquivo json para teste de regressor" src="img/8a2f618201273113.png"></p>
<p><strong>test_deployment(&#34;contact.json&#34;)</strong><br>A última parte desta aba se encarrega de enviar o objeto json que foi gravado no arquivo contact.json usando o método test_deployment(&#34;contact.json&#34;)</p>
<p class="image-container"><img alt="Teste Resultado" src="img/69fcc9dda9b7e715.png"></p>
<p><strong>Resultado do teste na aba Deployment</strong><br>O objeto json é exibido para o pesquisador conferir se os resultados estão de acordo com o esperado.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Implantação e logs" duration="2">
        <p>Cada projeto pode ter vários experimentos, porém apenas um deles será implantado.<br>Espera-se que os experimentos sejam criados e explorados até que o pesquisador se decida pela implantação de um deles para execução em tempo real no servidor.</p>
<p class="image-container"><img alt="Experimento executar" src="img/6b0279e24d4c15f1.png"></p>
<p>Depois de criada a atividade desejada, ela deve ser <strong>executada</strong> para permitir sua implantação.<br>Se ocorrer algum erro durante sua execução o botão de implantação fica bloqueado.</p>
<p class="image-container"><img alt="Experimento implantar" src="img/d4b06af2bf211c1e.png"></p>
<p>O botão <strong>Implantação</strong> somente será liberado após uma execução completa da atividade sem nenhum erro.<br>É importante lembrar que este botão será liberado somente uma vez para cada projeto.<br>Caso dois ou mais experimentos apresentem bons resultados então o pesquisador deve considerar a possibilidade de criar novos projetos para eles.</p>
<p class="image-container"><img alt="Experimento implantado" src="img/fae992b5b4e820d0.png"></p>
<p>A janela de <strong>Experimentos Implantados</strong> mostra os experimentos implantados pelo pesquisador.<br>A coluna &#34;Status&#34; apresenta a situação atual do experimento. O experimento deve ter o status &#34;Succeeded&#34; para poder ser executado.<br>A coluna &#34;Nome&#34; apresenta o nome do experimento implantado.<br>   É importante ressaltar que este nome é composto pelo nome do projeto seguido pelo nome do experimento selecionado.<br>A coluna &#34;URL&#34; contém a url do experimento implantado. Ela pode ser usada em um terminal de comandos Unix/Linux.<br>A coluna &#34;Data de Criação&#34; contém a data e a hora da implantação do experimento.<br>A coluna &#34;Ação&#34; contém três opções:<br>   <strong>&#34;Deletar&#34;</strong> (apagar) o experimento<br>   <strong>&#34;Testar Inferência&#34;</strong> para executar o experimento enviando um arquivo CSV para o modelo.<br>   <strong>&#34;Logs&#34;</strong> para visualizar a mensagens do modelo em execução.</p>
<p>A ação <strong>Testar Inferência</strong> apresenta em uma janela o resultado recebido da execução do modelo no servidor.<br>O título desta janela é <strong>Predições</strong></p>
<p class="image-container"><img alt="Experimento testado" src="img/a689a14897ca7cd5.png"></p>
<p>A ação <strong>Logs</strong> exibe uma janela para logs.<br>Como a quantidade de mensagens de log costuma ser grande esta janela possui paginação.<br>Note que as mensagens mais recentes ficam no fim da lista.</p>
<p class="image-container"><img alt="Experimento log" src="img/3eee7215e7c7c2ba.png"></p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>

</body>
</html>
